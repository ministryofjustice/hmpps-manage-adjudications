{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}

{% macro hearingSummary(hearingDetails = {}, attributes = {}, changeLinksActive = false, basicHearingChangeLinkHref = null, adjudicationNumber = null, hearingId = null) %}

  {% if changeLinksActive %}
    {% set dateTimeChangeLink = {
        items: [
          {
            href: basicHearingChangeLinkHref,
            text: "Change",
            visuallyHiddenText: ' date and time of hearing',
            attributes: {"data-qa": "change-link" }
          }
        ]
      } %}
    {% set locationChangeLink = {
        items: [
          {
            href: basicHearingChangeLinkHref,
            text: "Change",
            visuallyHiddenText: ' location',
            attributes: {"data-qa": "change-link" }
          }
        ]
      } %}
    {% set typeChangeLink = {
    items: [
      {
        href: basicHearingChangeLinkHref,
        text: "Change",
        visuallyHiddenText: ' type of hearing',
        attributes: {"data-qa": "change-link" }
      }
    ]
  } %}
    {# {% set adjudicatorChangeLink = {
    items: [
      {
        href: adjudicationUrls.enterHearingOutcome.urls.edit(adjudicationNumber, hearingId), 
        text: "Change",
        visuallyHiddenText: ' name of adjudicator',
        attributes: {"data-qa": "change-link-hearing-outcome-adjudicator-name" }
      }
    ]
  } %} #}
    {# {% set nextStepChangeLink = {
    items: [
      {
        href: adjudicationUrls.enterHearingOutcome.urls.edit(adjudicationNumber, hearingId), 
        text: "Change",
        visuallyHiddenText: ' next step',
        attributes: {"data-qa": "change-link-hearing-outcome-next-step" }
      }
    ]
  } %} #}
  {% endif %}

  {% set rows = [
    {
        key: { text: 'Date and time of hearing' },
        value: { text: hearingDetails.dateTimeOfHearing | formatTimestampTo('D MMMM YYYY - HH:mm') },
        actions: dateTimeChangeLink
    },
    {
        key: { text: 'Location' },
        value: { text: hearingDetails.locationName },
        actions: locationChangeLink
    },
    {
        key: { text: 'Type of hearing' },
        value: { text: hearingDetails.oicHearingType | convertOicHearingType },
        actions: typeChangeLink
    }
  ] %}

  {# Add the extra rows to the hearing table depending on the hearing outcome #}
  {% if hearingDetails.outcome %}
    {% if hearingDetails.outcome.code === HearingOutcomeCode.REFER_POLICE %}
      {% include '../partials/hearingDetailsVariations/hearingTableExpansions/hearingTableReferPoliceExpansion.njk' %}
    {% endif %}
    {% if hearingDetails.outcome.code === HearingOutcomeCode.REFER_INAD %}
      {% include '../partials/hearingDetailsVariations/hearingTableExpansions/hearingTableReferInAdExpansion.njk' %}
    {% endif %}
    {% if hearingDetails.outcome.code === HearingOutcomeCode.COMPLETE %}
    {# TODO: This one needs more sorting out when backend changes are made #}
      {% include '../partials/hearingDetailsVariations/hearingTableExpansions/hearingTableComplete.njk' %}
    {% endif %}
    {% if hearingDetails.outcome.code === HearingOutcomeCode.ADJOURN %}
      {% include '../partials/hearingDetailsVariations/hearingTableExpansions/hearingTableAdjourn.njk' %}
    {% endif %}
  {% endif %}

  {% if rows.length %}
    {{ govukSummaryList({
      rows: rows,
      attributes: attributes
    }) }}
  {% endif %}
{% endmacro %}